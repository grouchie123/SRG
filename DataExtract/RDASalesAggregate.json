{
	"type": "Custom SQL Extract",
	"SnowflakeSourceDB": "SRG_TST_EDW",
	"SnowflakeSourceSchema": "EDW",
	"SnowflakeTargetDB": "SRG_PRD_SANDPIT",
	"SnowflakeTargetSchema": "GROUP_ANALYTICS",
	"SnowflakeTargetViewName": "ADHOC_DATA_EXTRACT",
	"SQLTableValueFunction": "select d.FY       ,d.FINANCIALSHORTNAME as FY_MONTH       ,d.FINANCIALWEEKNUMBER as FY_WEEK       ,c.COMPANYCODE       ,c.COMPANYNAME       ,e.STORENAME       ,e.STORECODE       ,case when b.ACCOUNTCODE  = 'RS' then 'MEMBER' else 'NON-MEMBER' end as ACCOUNTTYPE       ,h.CUSTOMERCODE       ,f.CHANNELCODE       ,f.CHANNELNAME       ,a.ONLINESALE as ONLINEIND       ,g.CATEGORYCODE       ,g.CATEGORYNAME       ,g.SUBCATEGORYCODE       ,g.SUBCATEGORYNAME       ,g.MERCHCATEGORYCODE       ,g.MERCHCATEGORYNAME       ,sum(SALESGROSS) as SALESGROSS       ,sum(SALESNET) as SALESNET from EDW.FACT_TRANSACTION a left join EDW.DIM_ACCOUNT b on a.ACCOUNT_FK = b.ID left join EDW.DIM_COMPANY c on a.COMPANY_FK = c.ID left join EDW.REF_CALENDAR_DATE d on d.CALENDARDATE = a.BASKETDATE left join EDW.DIM_STORE e on a.STORE_FK = e.ID left join EDW.DIM_CHANNEL f on a.CHANNEL_FK = f.ID left join EDW.DIM_MERCHHIERARCHY g on a.MERCHHIERARCHY_FK = g.ID and a.COMPANY_FK = g.COMPANY_FK left join EDW.DIM_CUSTOMER h on h.ID = a.CUSTOMER_FK where c.COMPANYCODE in ('1000', '4000')       -- companycode '1000' = SCA, companycode '2000' = 'SCA NZ' , companycode '4000' = BCF, companycode '6510' = rebel --       and d.CALENDARDATE between '2020-12-01' and '2020-12-31'       --and a.RETURNIND = 0       and a.CREDITREDEMPIND = 0       and a.FREIGHTIND = 0       and a.DONATIONIND = 0       and a.ANZEVENTSIND = 0       and a.UNIFORMSIND = 0       and a.GIFTCARDIND = 0       and b.ACCOUNTCODE not like 'Z%' group by d.FY         ,d.FINANCIALSHORTNAME         ,d.FINANCIALWEEKNUMBER         ,d.CALENDARYEAR         ,d.CALENDARMONTHNAME         ,c.COMPANYCODE         ,c.COMPANYNAME         ,e.STORENAME         ,e.STORECODE         ,ACCOUNTTYPE         ,h.CUSTOMERCODE         ,f.CHANNELCODE         ,f.CHANNELNAME         ,a.ONLINESALE         ,g.CATEGORYCODE         ,g.CATEGORYNAME         ,g.SUBCATEGORYCODE         ,g.SUBCATEGORYNAME         ,g.MERCHCATEGORYCODE         ,g.MERCHCATEGORYNAME"
}
